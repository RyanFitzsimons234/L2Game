<!doctype html>

<body>


    <canvas id="gameCanvas" width="600" height="600"></canvas>
    <script>
        var canvas, canvasContext, imageAssests;

        window.onload = function () {
            canvas = document.getElementById('gameCanvas');
            canvasContext = canvas.getContext('2d');
            imageAssests = loadImgAssests();

            document.addEventListener('keydown', keyPressed); //keyPressed = made function 
            document.addEventListener('keyup', keyReleased); //keyReleased = made function 

            setInterval(mainloop, 1000 / 50);
        }





        var playerXspeed = 5;
        var playerYspeed = 5;

        var ENEMY_WIDTH = 30;
        var ENEMY_HEIGHT = 200;
        var enemyYpos = 700;
        var enemyXpos = 300;
        var enemyXspeed = 5;

        const PLAYER_SIZE = 20; // the players size

        const RIGHT_KEY = 39;
        const LEFT_KEY = 37;
        const DOWN_KEY = 40;
        const UP_KEY = 38;

        var rightKeyPressed = false;
        var leftKeyPressed = false;
        var downKeyPressed = false;
        var upKeyPressed = false;

        var background1 = new Image();
        background1.src = "Images/background1.png";

        var enemy1= new Image();
        enemy1.src = "Images/enemy1.png";

        var playerXsource = 0;
        var playerYsource = 0;
        const PLAYER_WIDTH= 148; // the players size
        const PLAYER_HEIGHT= 100; // the players size
        var playerXpos = 360;
        var playerYpos = 450;
        const PLAYERAWIDTH= 74; // the players size
        const PLAYERAHEIGHT= 50; // the players size   

        var  playerSpriteArray = [];
        const PLAYER_SPRITES = 8;
        var playerSpriteNum = 0;  
        var playerSpriteSheetCols = 0;

        function mainloop() {
            drawImg(background1, 0, 0, canvas.width, canvas.height); // bg
            drawImg(enemy1, enemyXpos, enemyYpos, ENEMY_WIDTH, ENEMY_HEIGHT);
            drawSprite(imageAssests.player, playerXsource, playerYsource, PLAYER_WIDTH, PLAYER_HEIGHT, playerXpos, playerYpos, PLAYERAWIDTH , PLAYERAHEIGHT);

            playerAnimation();

            PlayerMove();
            EnemyMove();
        }

        function loadImgAssests(){
                imgs = {};

                imgs.player = new Image();
                imgs.player.src = "images/player1.png";

                return imgs;
            }

            for(i=0; i< PLAYER_SPRITES; i++){
                playerSpriteArray[i] = new Array(2);
                playerSpriteArray[i][0]= PLAYER_WIDTH * (i % 4);
                // console.log(playerSpriteArray[i][0]);

                if(i != 0 && i%4 == 0){
                    playerSpriteSheetCols++;
                }
                playerSpriteArray[i][1]= PLAYER_HEIGHT * playerSpriteSheetCols;
                console.log(playerSpriteArray[i]);
            }

            function playerAnimation(){
                playerXsource = playerSpriteArray[playerSpriteNum][0];
                playerYsource = playerSpriteArray[playerSpriteNum][1];

                playerSpriteNum++;

                if(playerSpriteNum > 7){
                    playerSpriteNum = 0;

                }
            }


            
            function drawSprite(img, sX, sY, sW, sH, dX, dY, dW, dH){
                canvasContext.drawImage(img, sX, sY, sW, sH, dX, dY, dW, dH)
            }



            function drawImg(src,x,y,w,h){
            canvasContext.drawImage(src,x,y,w,h)
            }













        function keyPressed(evt) { //when key is pressed sets the key pressed to true
            console.log(evt.keyCode)
            if (evt.keyCode == RIGHT_KEY) {
                rightKeyPressed = true;
            }
            if (evt.keyCode == LEFT_KEY) {
                leftKeyPressed = true;
            }
            if (evt.keyCode == DOWN_KEY) {
                downKeyPressed = true;
            }
            if (evt.keyCode == UP_KEY) {
                upKeyPressed = true;
            }
        } //end func

        function keyReleased(evt) { // when key is released sets the key pressed to false
            console.log(evt.keyCode)
            if (evt.keyCode == RIGHT_KEY) {
                rightKeyPressed = false;
            }
            if (evt.keyCode == LEFT_KEY) {
                leftKeyPressed = false;
            }
            if (evt.keyCode == DOWN_KEY) {
                downKeyPressed = false;
            }
            if (evt.keyCode == UP_KEY) {
                upKeyPressed = false;
            }
        } //end func

        function PlayerMove() {
            if (rightKeyPressed && playerXpos < canvas.width * .965) {
                playerXpos += playerXspeed; //creates a barrier to the right for the player 
            }
            if (leftKeyPressed && playerXpos > canvas.width * .005) {
                playerXpos -= playerXspeed;
            }
            if (downKeyPressed && playerYpos < canvas.height * .965) {
                playerYpos += playerYspeed;
            }
            if (upKeyPressed && playerYpos > canvas.height * .005) {
                playerYpos -= playerYspeed;
            }
        } // end 

        function MakeEnemy() { // gets all info for each enemy and pushes into array
        }


            function EnemyMove() {
                enemyYpos -= enemyXspeed;
                if (enemyYpos < -50)
                    enemyYpos = 1000; //moves enemies across the screen


                    if (enemyXpos < playerXpos + PLAYERAWIDTH &&
                        enemyXpos + ENEMY_WIDTH > playerXpos &&
                        enemyYpos < playerYpos + PLAYERAHEIGHT &&
                        enemyYpos + ENEMY_HEIGHT > playerYpos){
                            alert("you lose")
                        }


                    //     // playing = false; // when player is touching enemies kill the player
                    }
                ; // end func
    </script>
</body>